"use strict";var M=Object.defineProperty,z=(l,c,a)=>c in l?M(l,c,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[c]=a,n=(l,c,a)=>(z(l,"symbol"!=typeof c?c+"":c,a),a);(self.webpackChunkpunto_digital=self.webpackChunkpunto_digital||[]).push([[788],{788:(l,c,a)=>{a.r(c),a.d(c,{LoansModule:()=>h});var u=a(8583),Z=a(2498),s=a(665),e=a(639),O=a(2340),g=a(5917),f=a(8002),v=a(5304),S=a(1841);const _=class{constructor(i){n(this,"http"),n(this,"url",O.N.endpoint_url),this.http=i}getLoans(){return this.http.get(`${this.url}/prestamo`).pipe((0,f.U)(i=>i),(0,v.K)(()=>(0,g.of)([])))}updateLoan(i){return this.http.put(`${this.url}/prestamo`,i).pipe((0,f.U)(t=>t),(0,v.K)(()=>(0,g.of)([{error:"No se pudo actualizar"}])))}createLoan(i){return this.http.post(`${this.url}/prestamo`,i).pipe((0,f.U)(t=>t),(0,v.K)(()=>(0,g.of)([{error:"No se pudo crear"}])))}getLoan(i){return this.http.get(`${this.url}/prestamo/${i}`).pipe((0,f.U)(t=>t),(0,v.K)(()=>(0,g.of)([])))}};let m=_;n(m,"\u0275fac",function(t){return new(t||_)(e.LFG(S.eN))}),n(m,"\u0275prov",e.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}));var x=a(3364),N=a(1249);const C=function(o){return["/","prestamos",o]};function L(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"article",5),e.TgZ(1,"div",6),e.TgZ(2,"h2",7),e._uU(3),e.qZA(),e.TgZ(4,"small",8),e._uU(5),e.qZA(),e.qZA(),e.TgZ(6,"div",9),e.TgZ(7,"p"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"p"),e._uU(11),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"p"),e._uU(14),e.qZA(),e.TgZ(15,"p"),e._uU(16),e.qZA(),e.qZA(),e.TgZ(17,"button",10),e.NdJ("click",function(){const E=e.CHM(t).$implicit,U=e.oxw();return U.openEditor(),U.loadData(E)}),e.TgZ(18,"span",11),e._uU(19,"edit"),e.qZA(),e._uU(20," Editar "),e.qZA(),e.qZA()}if(2&o){const t=i.$implicit;e.xp6(2),e.Q6J("routerLink",e.VKq(13,C,t.Id_Prestamo)),e.xp6(1),e.Oqu(t.Nombre_usuario),e.xp6(2),e.hij("Equipo: ",t.Serial_Equipo,""),e.xp6(3),e.hij("Fecha del pr\xe9stamo: ",e.xi3(9,7,t.Fecha_Inicio,"short"),""),e.xp6(3),e.hij("Fecha de entrega: ",e.xi3(12,10,t.Fecha_Fin,"short"),""),e.xp6(3),e.hij("Observaciones de pr\xe9stamo: ",t.Observaciones_Inicio,""),e.xp6(2),e.hij("Observaciones de entrega: ",t.Observaciones_Fin,"")}}function J(o,i){1&o&&(e.TgZ(0,"option",23),e._uU(1,"Seleccione una opci\xf3n"),e.qZA()),2&o&&e.Q6J("value",null)}function y(o,i){if(1&o&&(e.TgZ(0,"option",24),e._uU(1),e.qZA()),2&o){const t=i.$implicit;e.Q6J("value",t.Id_Equipo),e.xp6(1),e.AsE(" ",t.Serial," ",t.Id_TipoEquipo," ")}}function w(o,i){1&o&&(e.TgZ(0,"option",23),e._uU(1,"Seleccione una opci\xf3n"),e.qZA()),2&o&&e.Q6J("value",null)}function $(o,i){if(1&o&&(e.TgZ(0,"option",24),e._uU(1),e.qZA()),2&o){const t=i.$implicit;e.Q6J("value",t.nick_name),e.xp6(1),e.hij(" ",t.nick_name," ")}}function Q(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"aside",12),e.TgZ(1,"form",13),e.NdJ("submit",function(){e.CHM(t);const p=e.oxw();return p.isCreateMode?p.createLoans():p.updateLoad()}),e.TgZ(2,"fieldset"),e.TgZ(3,"legend"),e.TgZ(4,"h2"),e._uU(5),e.qZA(),e.qZA(),e.TgZ(6,"label"),e._uU(7," Equipo a prestar "),e.TgZ(8,"select",14),e.YNc(9,J,2,1,"option",15),e.YNc(10,y,2,3,"option",16),e.qZA(),e.qZA(),e.TgZ(11,"label"),e._uU(12," Usuario al que se le va a prestar "),e.TgZ(13,"select",17),e.YNc(14,w,2,1,"option",15),e.YNc(15,$,2,2,"option",16),e.qZA(),e.qZA(),e.TgZ(16,"label"),e._uU(17," Fecha de inicio del pr\xe9stamo "),e._UZ(18,"input",18),e.qZA(),e.TgZ(19,"label"),e._uU(20," Fecha fin del pr\xe9stamo "),e._UZ(21,"input",19),e.qZA(),e.TgZ(22,"label"),e._uU(23," Observaciones antes del pr\xe9stamo "),e._UZ(24,"textarea",20),e.qZA(),e.TgZ(25,"label"),e._uU(26," Observaciones despu\xe9s del pr\xe9stamo "),e._UZ(27,"textarea",21),e.qZA(),e._UZ(28,"input",22),e.qZA(),e.qZA(),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.equipmentForm),e.xp6(4),e.hij("",t.isCreateMode?"Crear":"Editar"," pr\xe9stamo"),e.xp6(4),e.Q6J("ngIf",t.isCreateMode),e.xp6(1),e.Q6J("ngForOf",t.equipments),e.xp6(4),e.Q6J("ngIf",t.isCreateMode),e.xp6(1),e.Q6J("ngForOf",t.users),e.xp6(13),e.Q6J("value",t.isCreateMode?"Crear":"Editar")}}const A=class{constructor(i,t,r){n(this,"loanService"),n(this,"userService"),n(this,"equipmentService"),n(this,"loans$"),n(this,"users"),n(this,"equipments"),n(this,"equipmentForm",new s.cw({})),n(this,"isEditorOpen",!1),n(this,"isCreateMode",!1),this.loanService=i,this.userService=t,this.equipmentService=r}ngOnInit(){this.loans$=this.loanService.getLoans(),this.equipmentForm=new s.cw({Id_Prestamo:new s.NI(0),Id_Equipo:new s.NI(0),nick_name:new s.NI(0),Nombre_usuario:new s.NI(""),Serial_Equipo:new s.NI(""),Fecha_Inicio:new s.NI(new Date),Fecha_Fin:new s.NI(new Date),Observaciones_Inicio:new s.NI(""),Observaciones_Fin:new s.NI("")})}loadData(i){this.isCreateMode=!1,i.Fecha_Fin=new Date(i.Fecha_Fin).toISOString().slice(0,16),i.Fecha_Inicio=new Date(i.Fecha_Inicio).toISOString().slice(0,16),this.userService.getUsers().subscribe(t=>{const r=t.find(p=>p.nick_name===i.Nombre_usuario);i.nick_name=r.nick_name,this.users=t,this.equipmentService.getEquipments().subscribe(p=>{const E=p.find(U=>U.Serial_Equipo===i.Serial);i.Id_Equipo=E.Id_Equipo,this.equipments=p,this.equipmentForm.setValue(i)})})}openEditor(){this.isEditorOpen=!0}updateLoad(){const i=this.equipmentForm.value;i.Id_TipoDocumento=Number(i.Id_TipoDocumento),this.loanService.updateLoan(this.equipmentForm.value).subscribe(t=>this.closeAndUpdate(t))}cleanFields(){const i={Id_Prestamo:0,Id_Equipo:null,nick_name:null,Nombre_usuario:"",Serial_Equipo:"",Fecha_Inicio:(new Date).toISOString().slice(0,16),Fecha_Fin:(new Date).toISOString().slice(0,16),Observaciones_Inicio:"",Observaciones_Fin:""};this.isCreateMode=!0,this.userService.getUsers().subscribe(t=>{this.users=t,this.equipmentService.getEquipments().subscribe(r=>{this.equipments=r}),this.equipmentForm.setValue(i)})}createLoans(){this.loanService.createLoan(this.equipmentForm.value).subscribe(i=>this.closeAndUpdate(i))}closeAndUpdate(i){i?.error||(this.isEditorOpen=!1,this.loans$=this.loanService.getLoans())}};let q=A;function Y(o,i){if(1&o&&(e.TgZ(0,"div",2),e.TgZ(1,"h2"),e._uU(2),e.qZA(),e.TgZ(3,"h3"),e._uU(4),e.ALo(5,"date"),e.ALo(6,"date"),e.qZA(),e.TgZ(7,"p"),e._uU(8),e.qZA(),e.TgZ(9,"p"),e._uU(10),e.qZA(),e.TgZ(11,"p"),e._uU(12),e.qZA(),e.qZA()),2&o){const t=i.$implicit;e.xp6(2),e.AsE("USUARIO: ",t.Id_Prestamo," - ",t.Nombre_usuario,""),e.xp6(2),e.AsE("PR\xc9STAMO DESDE: ",e.xi3(5,7,t.Fecha_Inicio,"short")," hasta ",e.xi3(6,10,t.Fecha_Fin,"short"),""),e.xp6(4),e.hij("Serial del equipo: ",t.Serial_Equipo,""),e.xp6(2),e.hij("Observaciones pr\xe9stamo: ",t.Observaciones_Inicio,""),e.xp6(2),e.hij("Observaciones entrega: ",t.Observaciones_Fin,"")}}n(q,"\u0275fac",function(t){return new(t||A)(e.Y36(m),e.Y36(x.f),e.Y36(N.Q))}),n(q,"\u0275cmp",e.Xpm({type:A,selectors:[["app-loans"]],decls:7,vars:4,consts:[[1,"main"],["class","card",4,"ngFor","ngForOf"],[1,"btn","btn--circle","btn--float",3,"click"],[1,"material-symbols-outlined","btn__icon","btn--3h"],["class","aside",4,"ngIf"],[1,"card"],[1,"card__title"],[1,"card__title--route",3,"routerLink"],[1,"card__status"],[1,"card__content"],["type","button",1,"btn",3,"click"],[1,"material-symbols-outlined"],[1,"aside"],[3,"formGroup","submit"],["formControlName","Id_Equipo"],["disabled","",3,"value",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["formControlName","nick_name"],["formControlName","Fecha_Inicio","type","datetime-local"],["formControlName","Fecha_Fin","type","datetime-local"],["formControlName","Observaciones_Inicio"],["formControlName","Observaciones_Fin"],["type","submit",1,"btn","btn--primary",3,"value"],["disabled","",3,"value"],[3,"value"]],template:function(t,r){1&t&&(e.TgZ(0,"main",0),e.YNc(1,L,21,15,"article",1),e.ALo(2,"async"),e.TgZ(3,"button",2),e.NdJ("click",function(){return r.cleanFields(),r.openEditor()}),e.TgZ(4,"span",3),e._uU(5,"add"),e.qZA(),e.qZA(),e.qZA(),e.YNc(6,Q,29,7,"aside",4)),2&t&&(e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,2,r.loans$)),e.xp6(5),e.Q6J("ngIf",r.isEditorOpen))},directives:[u.sg,u.O5,Z.rH,s._Y,s.JL,s.sg,s.EJ,s.JJ,s.u,s.Fj,s.YN,s.Kr],pipes:[u.Ov,u.uU],styles:[""]}));const T=class{constructor(i,t){n(this,"personService"),n(this,"activatedRoute"),n(this,"loan$"),this.personService=i,this.activatedRoute=t}ngOnInit(){const{id:i}=this.activatedRoute.snapshot.params;this.loan$=this.personService.getLoan(i)}};let F=T;n(F,"\u0275fac",function(t){return new(t||T)(e.Y36(m),e.Y36(Z.gz))}),n(F,"\u0275cmp",e.Xpm({type:T,selectors:[["app-loan"]],decls:3,vars:3,consts:[[1,"content","content--center"],["class","message",4,"ngFor","ngForOf"],[1,"message"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Y,13,13,"div",1),e.ALo(2,"async"),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,r.loan$)))},directives:[u.sg],pipes:[u.Ov,u.uU],styles:[""]}));const j=[{path:"",component:q},{path:":id",component:F}],b=class{};let d=b;n(d,"\u0275fac",function(t){return new(t||b)}),n(d,"\u0275mod",e.oAB({type:b})),n(d,"\u0275inj",e.cJS({imports:[[Z.Bz.forChild(j)],Z.Bz]}));const I=class{};let h=I;n(h,"\u0275fac",function(t){return new(t||I)}),n(h,"\u0275mod",e.oAB({type:I})),n(h,"\u0275inj",e.cJS({imports:[[u.ez,d,s.UX]]}))}}]);